# 수정 사항 분석 및 계획

## 스크린샷 기반 분석 결과

---

## 1. 대시보드 (Dashboard)
**파일 위치**: `app/(authenticated)/dashboard/page.tsx`

### 1-1. 근무 상태 카드
- 허브스태프 연동 상황에 따라 변경 및 삭제 가능
- **현재 상태**: 유지 (추후 허브스태프 연동 시 수정)

### 1-2. 연차 요약 카드
**파일 위치**: `components/dashboard/LeaveBalanceCard.tsx`
- **변경 사항**: 포상휴가 부분 삭제
- **현재**: 잔여연차 + 잔여포상휴가 (두 컬럼)
- **수정 후**: 잔여연차만 표시 (단일 컬럼)

### 1-3. 빠른 메뉴 카드
**파일 위치**: `components/dashboard/QuickActions.tsx`
- **변경 사항**:
  - 회의실 예약
  - 기안함 (현재: 결재 문서)
  - 결재함 (현재: 없음, 좌석 등록 대신)
- **현재**: 회의실 예약 / 좌석 등록 / 결재 문서 (3개)
- **수정 후**: 회의실 예약 / 기안함 / 결재함 (3개)

---

## 2. 좌석 예약 (Seats)
**파일 위치**: `app/(authenticated)/resources/seats/page.tsx` (신규 생성 필요)

### 2-1. 맵 뷰
- 구현 예정 (후순위)

### 2-2. 좌석 목록
- 좌석 목록 선택 후 사용 등록
- 좌석 점유 시 이름 / 상태 표시

---

## 3. 공간 예약 (구: 회의실 예약)
**파일 위치**: `app/(authenticated)/meeting-rooms/page.tsx` 및 관련 컴포넌트

### 3-1. 이름 변경
- '회의실 예약' → '공간 예약'
- 사이드바 및 관련 모든 텍스트 변경

### 3-2. 층별 상태값 제외
- 현재: 층별 상태 표시
- 수정: 제거

### 3-3. 사진 추가
- 회의실 이미지 표시 (촬영 완료 / 전달 예정)

### 3-4. 검색 기능 추가
- 날짜 / 시간 입력 시 해당 시각 비어있는 회의실만 표시

### 3-5. 예약 정보 입력
- 캘린더 선택 시 예약 현황도 해당 날짜로 연동
- 최대 2시간 예약으로 변경
- 09:00 - 19:00만 예약 가능

### 3-6. 회의실 이용 정책 표시
```
- 회의실은 함께 쓰는 공간입니다. 항상 깨끗하게 정리해주세요.
- 최대 예약 시간은 2시간 입니다.
- 장비에 문제가 있을 시 담당자(누구)에게 즉시 연락 주세요.
- 다음 예약이 있을 시 최소 15분 전까지 비워주세요.
```

---

## 4. 연차 신청 페이지
**파일 위치**: `components/request/RequestForm.tsx`

### 4-1. 상단 카드 변경
- 날짜 / 부재유형 / 사용일수 / 상태 / 상세보기

### 4-2. 날짜별 종일/오전/오후 선택
**핵심 비즈니스 로직**:

#### 전제 조건
1. 사용자는 기간 내 모든 날짜의 옵션(종일/오전/오후)을 반드시 선택해야 함
2. 2일 신청 시: HR 정책 및 기획 정책에 따라 종료일은 '종일'만 허용

#### 유효성 검증 로직
1. **공통 검증 (기간 무관)**
   - 시작일: `종일` or `오후 반차` (오전 반차 X)
   - 종료일: `종일` or `오전 반차` (오후 반차 X)
   - 중간일(존재 시): 무조건 `종일`

2. **2일 특화 검증 (HR 제약)**
   - IF (시작일 == `오후 반차` AND 종료일 == `오전 반차`):
     - Return **Fail** (양일 근무 발생으로 별건 처리 필요)

#### 케이스 정리 (3일 지정 시: 12.01 ~ 12.03)
| Case | 1일차 | 2일차 | 3일차 | 결과 |
|------|-------|-------|-------|------|
| 1 | 종일 | 종일 | 종일 | ✅ 승인 (3.0일) |
| 2 | 오후반차 | 종일 | 종일 | ✅ 승인 (2.5일) |
| 3 | 종일 | 종일 | 오전반차 | ✅ 승인 (2.5일) |
| 4 | 오후반차 | 종일 | 오전반차 | ✅ 승인 (2.0일) |
| 5 | 오전반차 | 종일 | 종일 | 🚫 불가 (시작일 위반) |
| 6 | 종일 | 오전반차 | 종일 | 🚫 불가 (중간일 위반) |
| 7 | 종일 | 오후반차 | 종일 | 🚫 불가 (중간일 위반) |
| 8 | 종일 | 종일 | 오후반차 | 🚫 불가 (종료일 위반) |

---

## 5. 문서 종류 및 입력 필드

### 5-1. 문서 종류 목록
1. **연차 신청**
2. **연차 예외 사용 신청서** (당일/사후/마이너스)
3. **포상 휴가 신청**
4. **근로 형태 변경 신청**
   - 무급병가 (연 60일)
   - 공가 휴가 (예비군/민방위 등)
   - 휴직 (무급)
   - 육아 휴직
   - 경조사 휴가
   - 출산전후 휴가 (90일)
   - 배우자출산휴가 (20일)
   - 임신 중 단축근무
   - 근무 변경 (대부분 재택)
   - 출장 / 외근
   - 여성 보건 휴가
5. **경조사비 신청**
6. **연장 근로 신청** - 사전 (당일 퇴근 1시간 전 - 부서장 승인 필요) / 시각 선택 - 1시간 식사시간 제외
7. **연장 근로 보고** - 연장 근로 신청 최종 승인 이후 48시간 이내 제출 알림
8. **예산 신청서**
9. **지출 품의서**
10. **지출 결의서** - 결재선 (HR 팀원 - HR 리더) 고정
11. **사직서**
12. **기타 기안**

### 5-2. 문서별 입력 필드

#### 공통 필드 (모든 문서)
- 파일 첨부
- 기존 문서 참조
- 결재선 지정
- 참조자 지정

#### 연차/휴가 관련 (연차 신청, 연차 예외, 포상 휴가, 근로 형태 변경)
- 시작일 / 종료일 (캘린더)
- 상세 내역 (텍스트)

#### 경조사비 신청
- 제목 (텍스트)
- 상세내역 (텍스트)

#### 연장 근로 신청
- 신청일 (캘린더) / 신청 시간 (시작 시각 / 종료 시각)
- 상세 내역 (텍스트)

#### 연장 근로 보고
- 신청일 (캘린더) / 신청 시간 (시작 시각 / 종료 시각)
- 상세 내역 (텍스트)

#### 예산 신청서
- 제목 / 건명 (텍스트)
- 예산 사용 부서 (드롭다운 - 조직 선택)
- 예산 사용 기간 (캘린더 - 시작일 / 종료일)
- 산출 근거 (텍스트)
- 신청 총액 (텍스트)

#### 지출 품의서
- 제목 / 건명 (텍스트)
- 지출 예정 일자 (캘린더)
- 지출 사유 (텍스트)
- 품목 / 수량 / 가격 (각각 텍스트 / '+' 버튼으로 추가)
- 총 예상 공급가액 / 부가세 / 총액 (각각 텍스트)
- 거래 예정처 (업체명) (텍스트)

#### 지출 결의서
- 지출 일자 (캘린더)
- 지출 사유 (텍스트)
- 품목 / 수량 / 가격 (각각 텍스트 / '+' 버튼으로 추가)
- 지급 방법 (법인카드 / 세금계산서(이체) / 개인카드 - 드롭다운)
- 이체 정보 (세금계산서 선택 시 생성 → 은행명 / 계좌번호 / 예금주명)

#### 사직서
- 입사일 (캘린더)
- 사직 희망일 (캘린더)
- 사직 사유 (일신상의 사유 / 계약 만료 / 권고사직 / 기타 - 드롭다운)
- 상세 사유 (텍스트)
- 서약 및 확인 (체크박스):
  - "본인은 퇴사 전까지 담당 업무에 대한 인수인계를 성실히 이행하겠습니다."
  - "재직 중 취득한 회사의 영업비밀을 퇴사 후에도 유출하지 않겠습니다."
  - "본 사직서는 본인의 자유로운 의사에 따라 제출하는 것임을 확인합니다."

#### 기타 기안
- 제목 (텍스트)
- 상세내역 (텍스트)

---

## 6. 기안함 / 결재함

### 6-1. 사이드바
- '내 문서' → '기안함'으로 변경

### 6-2. 탭별 필터링 테스트 필요
- 문서가 탭별로 잘 필터링되는지 전체 테스트

### 6-3. 문서 다운로드 기능 추가

### 6-4. 결재함 UI
- 문서 제목 노출
- 신청일시는 날짜까지만 표시

---

## 7. 관리자 - 구성원 관리
**파일 위치**: `components/admin/EmployeeTable.tsx`

### 7-1. 삭제 버튼 제거
- ✅ 이미 완료됨

### 7-2. 잔여 연차 / 포상 휴가 컬럼 삭제
- 현재: 잔여연차 컬럼 있음
- 수정: 삭제

---

## 8. 관리자 - 연차 관리
**파일 위치**: `app/(authenticated)/admin/leave-management/page.tsx`

### 8-1. 정책 설정 버튼 및 모달 삭제
- 연차 정책 설정 및 부재 양식 커스텀 기능 제외

### 8-2. 연차 신청자의 잔여 연차 표시
- 연차 신청자의 잔여 연차 정보 보여야 함

---

## 9. 관리자 - 조직 관리
**파일 위치**: `components/admin/OrganizationManagementClient.tsx`

### 9-1. 하위 부서 인원 합산 표시 수정
**현재 문제**:
- 경영지원 (0명) > HR팀 (4명)
- HR팀 직접 소속 인원만 표시

**수정 후**:
- 경영지원 (4명) - 하위 부서 인원 합산
- HR팀 (4명)

**수정 필요 파일**:
- `supabase/migrations/` - department_with_stats 뷰 수정
- 또는 프론트엔드에서 계산

---

## 우선순위

### Phase 1 - 긴급 (UI/UX 개선)
1. [ ] 대시보드 - 연차요약 포상휴가 삭제
2. [ ] 대시보드 - 빠른메뉴 변경 (기안함/결재함)
3. [ ] 구성원 관리 - 잔여연차 컬럼 삭제
4. [ ] 조직도 - 하위 부서 인원 합산 표시
5. [ ] 사이드바 - 내 문서 → 기안함 변경

### Phase 2 - 높음 (핵심 기능)
6. [ ] 연차 신청 - 날짜별 종일/오전/오후 유효성 검증
7. [ ] 회의실 → 공간 예약 이름 변경
8. [ ] 공간 예약 - 최대 2시간, 09:00-19:00 제한
9. [ ] 연차 관리 - 정책 설정 버튼 삭제

### Phase 3 - 중간 (기능 확장)
10. [ ] 다양한 문서 종류 추가
11. [ ] 문서별 입력 필드 구현
12. [ ] 문서 다운로드 기능
13. [ ] 공간 예약 - 검색 기능 (시간대별 빈 회의실)

### Phase 4 - 낮음 (후순위)
14. [ ] 좌석 예약 페이지 (맵뷰)
15. [ ] 회의실 사진 추가
